{"version":3,"file":"index.js","mappings":";;;;;;;;;;AAAA,qC;;;;;;;;;;;ACAA,+B;;;;;;;;;;;ACAA,iC;;;;;;;;;;;ACAA,iC;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA,QAAQ,qCAAqC,EAAE,mBAAO,CAAC,0BAAU;AACjE,aAAa,mBAAO,CAAC,kBAAM;AAC3B,aAAa,mBAAO,CAAC,kBAAM;AAC3B,WAAW,mBAAO,CAAC,cAAI;;AAEvB;AACA;AACA;AACA,6BAA6B,YAAY,GAAG,YAAY;AACxD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAAgC,WAAW,gBAAgB,eAAe;AAC1E;AACA,sDAAsD,WAAW;AACjE;AACA;AACA,cAAc;AACd;AACA;AACA,iBAAiB;AACjB,cAAc;AACd,+DAA+D,oBAAoB;AACnF;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,iBAAiB;AACjB,cAAc;AACd,2EAA2E,WAAW;AACtF;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,cAAc;AACd;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,iCAAiC,6CAA6C;AAC9E;;AAEA;AACA,QAAQ,IAAsC;AAC9C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,QAAQ;AAC9C;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,WAAW;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,MAAM;AACN;AACA,iBAAiB;AACjB;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,QAAQ;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,oCAAoC,QAAQ;AAC5C,sDAAsD,KAAK;AAC3D;AACA,qBAAqB;AACrB,SAAS;AACT;AACA;AACA;AACA,gCAAgC,WAAW,GAAG,iCAAiC;AAC/E;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,iBAAiB;AACjB,MAAM;AACN;AACA,iBAAiB;AACjB;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,aAAoB,IAAI,CAAY;AACrD;AACA;AACA,CAAC","sources":["webpack://workspace-client/external node-commonjs \"electron\"","webpack://workspace-client/external node-commonjs \"fs\"","webpack://workspace-client/external node-commonjs \"http\"","webpack://workspace-client/external node-commonjs \"path\"","webpack://workspace-client/webpack/bootstrap","webpack://workspace-client/./main.js"],"sourcesContent":["module.exports = require(\"electron\");","module.exports = require(\"fs\");","module.exports = require(\"http\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/**\n * Workspace Client - Electron Main Process\n * GÃ¨re la fenÃªtre d'application et la connexion au serveur distant\n */\nconst { app, BrowserWindow, ipcMain, shell } = require('electron');\nconst path = require('path');\nconst http = require('http');\nconst fs = require('fs');\n\n// Configuration\nconst SERVER_HOST = process.env.SERVER_HOST || 'localhost';\nconst SERVER_PORT = process.env.SERVER_PORT || 8060;\nconst SERVER_URL = `http://${SERVER_HOST}:${SERVER_PORT}`;\nconst MAX_RETRY_ATTEMPTS = 10;\nconst RETRY_INTERVAL = 500;\n\nlet mainWindow;\nlet pdfWindows = new Map();\nlet serverConnected = false;\n\n/**\n * VÃ©rifier la connexion au serveur distant\n */\nfunction checkServerConnection(retries = 0) {\n    return new Promise((resolve, reject) => {\n        const req = http.get(`${SERVER_URL}/api/health`, { timeout: 3000 }, (res) => {\n            if (res.statusCode === 200) {\n                console.log(`âœ… ConnectÃ© au serveur: ${SERVER_URL}`);\n                serverConnected = true;\n                resolve(true);\n            } else if (retries < MAX_RETRY_ATTEMPTS) {\n                setTimeout(() => {\n                    checkServerConnection(retries + 1).then(resolve).catch(reject);\n                }, RETRY_INTERVAL);\n            } else {\n                reject(new Error(`Serveur indisponible aprÃ¨s ${MAX_RETRY_ATTEMPTS} tentatives`));\n            }\n        });\n\n        req.on('error', () => {\n            if (retries < MAX_RETRY_ATTEMPTS) {\n                setTimeout(() => {\n                    checkServerConnection(retries + 1).then(resolve).catch(reject);\n                }, RETRY_INTERVAL);\n            } else {\n                reject(new Error(`Impossible de se connecter au serveur: ${SERVER_URL}`));\n            }\n        });\n\n        req.on('timeout', () => {\n            req.destroy();\n            if (retries < MAX_RETRY_ATTEMPTS) {\n                setTimeout(() => {\n                    checkServerConnection(retries + 1).then(resolve).catch(reject);\n                }, RETRY_INTERVAL);\n            } else {\n                reject(new Error('Timeout lors de la connexion au serveur'));\n            }\n        });\n    });\n}\n\n/**\n * CrÃ©er la fenÃªtre principale\n */\nfunction createWindow() {\n    mainWindow = new BrowserWindow({\n        width: 1200,\n        height: 800,\n        show: false,\n        webPreferences: {\n            nodeIntegration: false,\n            contextIsolation: true,\n            enableRemoteModule: false,\n            preload: path.join(__dirname, 'preload.js')\n        }\n    });\n\n    mainWindow.loadURL(`file://${path.join(__dirname, 'public', 'index.html')}`);\n    mainWindow.show();\n\n    // DevTools en dÃ©veloppement\n    if (process.env.NODE_ENV === 'development') {\n        mainWindow.webContents.openDevTools();\n    }\n\n    // Logs console Electron (filtrer le bruit)\n    mainWindow.webContents.on('console-message', (level, message) => {\n        if (typeof message === 'string' && \n            !message.includes('Autofill') && \n            !message.includes('atom_cache') &&\n            !message.includes('privileged')) {\n            console.log(`[Renderer] ${message}`);\n        }\n    });\n\n    mainWindow.webContents.on('destroyed', () => {\n        mainWindow = null;\n    });\n\n    mainWindow.on('closed', () => {\n        mainWindow = null;\n    });\n}\n\n/**\n * Ã‰vÃ©nement de dÃ©marrage Electron\n */\napp.on('ready', async () => {\n    try {\n        console.log('ðŸš€ DÃ©marrage Workspace Client...');\n        console.log(`ðŸ“ Serveur attendu: ${SERVER_URL}`);\n        \n        // Attendre la connexion au serveur\n        await checkServerConnection();\n        \n        createWindow();\n        console.log('âœ… Interface graphique lancÃ©e');\n        console.log('âœ¨ Application prÃªte');\n    } catch (error) {\n        console.error('âŒ Erreur initialisation:', error.message);\n        app.quit();\n    }\n});\n\n/**\n * Fermeture de toutes les fenÃªtres\n */\napp.on('window-all-closed', () => {\n    if (process.platform !== 'darwin') {\n        app.quit();\n    }\n});\n\n/**\n * Activation (macOS)\n */\napp.on('activate', () => {\n    if (mainWindow === null) {\n        createWindow();\n    }\n});\n\n/**\n * Avant la fermeture de l'application\n */\napp.on('before-quit', () => {\n    console.log('â¹ï¸  ArrÃªt de Workspace Client');\n    pdfWindows.forEach((win) => {\n        if (win && !win.isDestroyed()) {\n            win.close();\n        }\n    });\n    pdfWindows.clear();\n});\n\n\n/**\n * IPC Handlers - API exposÃ©e au renderer\n */\n\n/**\n * Ouvrir une URL externe\n */\nipcMain.handle('open-external', async (event, url) => {\n    try {\n        // Valider l'URL\n        const urlObj = new URL(url);\n        if (!['http:', 'https:', 'mailto:', 'ftp:'].includes(urlObj.protocol)) {\n            throw new Error('Protocole non autorisÃ©');\n        }\n        await shell.openExternal(url);\n        return { success: true };\n    } catch (error) {\n        console.error('âŒ Erreur ouverture URL:', error.message);\n        return { success: false, error: error.message };\n    }\n});\n\n/**\n * Ouvrir un fichier PDF\n */\nipcMain.handle('open-pdf-window', async (event, data) => {\n    try {\n        const { pdfFile, title } = data;\n        \n        // Validation\n        if (!pdfFile || typeof pdfFile !== 'string') {\n            throw new Error('Nom de fichier invalide');\n        }\n        \n        // SÃ©curitÃ© : empÃªcher les path traversal attacks\n        if (pdfFile.includes('..') || pdfFile.includes('/') || pdfFile.includes('\\\\')) {\n            throw new Error('Chemin de fichier non autorisÃ©');\n        }\n        \n        const pdfPath = path.join(__dirname, 'public', 'src', 'pdf', pdfFile);\n        \n        if (!fs.existsSync(pdfPath)) {\n            throw new Error(`Fichier PDF introuvable: ${pdfFile}`);\n        }\n        \n        const pdfWindow = new BrowserWindow({\n            width: 900,\n            height: 700,\n            webPreferences: {\n                nodeIntegration: false,\n                contextIsolation: true,\n                preload: path.join(__dirname, 'preload.js')\n            }\n        });\n        \n        pdfWindow.loadURL(`file://${pdfPath}`);\n        pdfWindow.webContents.setWindowOpenHandler(({ url }) => {\n            shell.openExternal(url);\n            return { action: 'deny' };\n        });\n        \n        pdfWindow.setTitle(title || 'PDF Viewer');\n        \n        const windowId = `pdf-${Date.now()}-${Math.floor(Math.random() * 1000)}`;\n        pdfWindow.id = windowId;\n        pdfWindows.set(windowId, pdfWindow);\n        \n        pdfWindow.on('closed', () => {\n            pdfWindows.delete(windowId);\n        });\n        \n        return { success: true, windowId };\n    } catch (error) {\n        console.error('âŒ Erreur ouverture PDF:', error.message);\n        return { success: false, error: error.message };\n    }\n});\n\n/**\n * Obtenir la configuration de l'application\n */\nipcMain.handle('get-app-config', async () => {\n    return {\n        serverUrl: SERVER_URL,\n        serverHost: SERVER_HOST,\n        serverPort: SERVER_PORT,\n        nodeEnv: process.env.NODE_ENV || 'production',\n        appVersion: app.getVersion()\n    };\n});\n"],"names":[],"ignoreList":[],"sourceRoot":""}