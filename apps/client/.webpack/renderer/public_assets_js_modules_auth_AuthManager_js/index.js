"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkworkspace_client"] = self["webpackChunkworkspace_client"] || []).push([["public_assets_js_modules_auth_AuthManager_js"],{

/***/ "./public/assets/js/modules/auth/AuthManager.js":
/*!******************************************************!*\
  !*** ./public/assets/js/modules/auth/AuthManager.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass AuthManager {\n    constructor(options = {}) {\n        this.user = null;\n        this.listeners = [];\n        this.serverUrl = options.serverUrl || 'http://localhost:8060';\n        this.token = null;\n        this.init();\n    }\n\n    init() {\n        const userId = localStorage.getItem('workspace_user_id');\n        const username = localStorage.getItem('workspace_username');\n        const token = localStorage.getItem('workspace_token');\n\n        if (userId && username && token) {\n            this.user = {\n                id: parseInt(userId),\n                username: username\n            };\n            this.token = token;\n            this.verifySession();\n        }\n    }\n\n    async verifySession() {\n        try {\n            const response = await fetch(`${this.serverUrl}/api/auth/verify`, {\n                method: 'GET',\n                headers: {\n                    'Authorization': `Bearer ${this.token}`,\n                    'Content-Type': 'application/json'\n                }\n            });\n\n            if (!response.ok) {\n                throw new Error(`HTTP ${response.status}`);\n            }\n\n            const data = await response.json();\n\n            if (!data.success) {\n                this.clearSession();\n            } else {\n                this.emit('auth-change', this.user);\n            }\n        } catch (error) {\n            console.error('❌ Erreur vérification session:', error);\n            this.clearSession();\n        }\n    }\n\n    async register(username, password) {\n        try {\n            const response = await fetch(`${this.serverUrl}/api/auth/register`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ username, password })\n            });\n\n            const data = await response.json();\n\n            if (data.success && data.token) {\n                this.setSession(data.user, data.token);\n            }\n\n            return data;\n        } catch (error) {\n            console.error('❌ Erreur register:', error);\n            return {\n                success: false,\n                message: 'Erreur de connexion au serveur'\n            };\n        }\n    }\n\n    async login(username, password) {\n        try {\n            const response = await fetch(`${this.serverUrl}/api/auth/login`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ username, password })\n            });\n\n            const data = await response.json();\n\n            if (data.success && data.token) {\n                this.setSession(data.user, data.token);\n            }\n\n            return data;\n        } catch (error) {\n            console.error('❌ Erreur login:', error);\n            return {\n                success: false,\n                message: 'Erreur de connexion au serveur'\n            };\n        }\n    }\n\n    logout() {\n        this.clearSession();\n        window.location.reload();\n        return {\n            success: true,\n            message: 'Déconnexion réussie'\n        };\n    }\n\n    setSession(user, token) {\n        this.user = user;\n        this.token = token;\n        localStorage.setItem('workspace_user_id', user.id);\n        localStorage.setItem('workspace_username', user.username);\n        localStorage.setItem('workspace_token', token);\n        this.emit('auth-change', this.user);\n        \n        // Émettre un événement global pour ChatManager\n        window.dispatchEvent(new CustomEvent('auth-change', { detail: { user } }));\n    }\n\n    clearSession() {\n        this.user = null;\n        this.token = null;\n        localStorage.removeItem('workspace_user_id');\n        localStorage.removeItem('workspace_username');\n        localStorage.removeItem('workspace_token');\n        this.emit('auth-change', null);\n        \n        // Émettre un événement global pour ChatManager\n        window.dispatchEvent(new CustomEvent('auth-change', { detail: { user: null } }));\n    }\n\n    isAuthenticated() {\n        return this.user !== null && this.token !== null;\n    }\n\n    getCurrentUser() {\n        return this.user;\n    }\n\n    getToken() {\n        return this.token;\n    }\n\n    on(event, callback) {\n        this.listeners.push({ event, callback });\n    }\n\n    emit(event, data) {\n        this.listeners.forEach(listener => {\n            if (listener.event === event) {\n                listener.callback(data);\n            }\n        });\n    }\n\n    destroy() {\n        this.listeners = [];\n        this.user = null;\n        this.token = null;\n    }\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AuthManager);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wdWJsaWMvYXNzZXRzL2pzL21vZHVsZXMvYXV0aC9BdXRoTWFuYWdlci5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsNENBQTRDLGVBQWU7QUFDM0Q7QUFDQTtBQUNBLCtDQUErQyxXQUFXO0FBQzFEO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0Esd0NBQXdDLGdCQUFnQjtBQUN4RDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRDQUE0QyxlQUFlO0FBQzNEO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQix1Q0FBdUMsb0JBQW9CO0FBQzNELGFBQWE7O0FBRWI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw0Q0FBNEMsZUFBZTtBQUMzRDtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsdUNBQXVDLG9CQUFvQjtBQUMzRCxhQUFhOztBQUViOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCxVQUFVLFFBQVE7QUFDaEY7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThELFVBQVUsY0FBYztBQUN0Rjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhCQUE4QixpQkFBaUI7QUFDL0M7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUVBQWUsV0FBVyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd29ya3NwYWNlLWNsaWVudC8uL3B1YmxpYy9hc3NldHMvanMvbW9kdWxlcy9hdXRoL0F1dGhNYW5hZ2VyLmpzP2RhOTYiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQXV0aE1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkge1xuICAgICAgICB0aGlzLnVzZXIgPSBudWxsO1xuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IFtdO1xuICAgICAgICB0aGlzLnNlcnZlclVybCA9IG9wdGlvbnMuc2VydmVyVXJsIHx8ICdodHRwOi8vbG9jYWxob3N0OjgwNjAnO1xuICAgICAgICB0aGlzLnRva2VuID0gbnVsbDtcbiAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuXG4gICAgaW5pdCgpIHtcbiAgICAgICAgY29uc3QgdXNlcklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3dvcmtzcGFjZV91c2VyX2lkJyk7XG4gICAgICAgIGNvbnN0IHVzZXJuYW1lID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3dvcmtzcGFjZV91c2VybmFtZScpO1xuICAgICAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd3b3Jrc3BhY2VfdG9rZW4nKTtcblxuICAgICAgICBpZiAodXNlcklkICYmIHVzZXJuYW1lICYmIHRva2VuKSB7XG4gICAgICAgICAgICB0aGlzLnVzZXIgPSB7XG4gICAgICAgICAgICAgICAgaWQ6IHBhcnNlSW50KHVzZXJJZCksXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy50b2tlbiA9IHRva2VuO1xuICAgICAgICAgICAgdGhpcy52ZXJpZnlTZXNzaW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyB2ZXJpZnlTZXNzaW9uKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLnNlcnZlclVybH0vYXBpL2F1dGgvdmVyaWZ5YCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLnRva2VufWAsXG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgICAgICAgaWYgKCFkYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyU2Vzc2lvbigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoJ2F1dGgtY2hhbmdlJywgdGhpcy51c2VyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJldXIgdsOpcmlmaWNhdGlvbiBzZXNzaW9uOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJTZXNzaW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyByZWdpc3Rlcih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5zZXJ2ZXJVcmx9L2FwaS9hdXRoL3JlZ2lzdGVyYCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB1c2VybmFtZSwgcGFzc3dvcmQgfSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzICYmIGRhdGEudG9rZW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlc3Npb24oZGF0YS51c2VyLCBkYXRhLnRva2VuKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyZXVyIHJlZ2lzdGVyOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0VycmV1ciBkZSBjb25uZXhpb24gYXUgc2VydmV1cidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBsb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5zZXJ2ZXJVcmx9L2FwaS9hdXRoL2xvZ2luYCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB1c2VybmFtZSwgcGFzc3dvcmQgfSlcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzICYmIGRhdGEudG9rZW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlc3Npb24oZGF0YS51c2VyLCBkYXRhLnRva2VuKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyZXVyIGxvZ2luOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0VycmV1ciBkZSBjb25uZXhpb24gYXUgc2VydmV1cidcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBsb2dvdXQoKSB7XG4gICAgICAgIHRoaXMuY2xlYXJTZXNzaW9uKCk7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBtZXNzYWdlOiAnRMOpY29ubmV4aW9uIHLDqXVzc2llJ1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHNldFNlc3Npb24odXNlciwgdG9rZW4pIHtcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy50b2tlbiA9IHRva2VuO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnd29ya3NwYWNlX3VzZXJfaWQnLCB1c2VyLmlkKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3dvcmtzcGFjZV91c2VybmFtZScsIHVzZXIudXNlcm5hbWUpO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnd29ya3NwYWNlX3Rva2VuJywgdG9rZW4pO1xuICAgICAgICB0aGlzLmVtaXQoJ2F1dGgtY2hhbmdlJywgdGhpcy51c2VyKTtcbiAgICAgICAgXG4gICAgICAgIC8vIMOJbWV0dHJlIHVuIMOpdsOpbmVtZW50IGdsb2JhbCBwb3VyIENoYXRNYW5hZ2VyXG4gICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnYXV0aC1jaGFuZ2UnLCB7IGRldGFpbDogeyB1c2VyIH0gfSkpO1xuICAgIH1cblxuICAgIGNsZWFyU2Vzc2lvbigpIHtcbiAgICAgICAgdGhpcy51c2VyID0gbnVsbDtcbiAgICAgICAgdGhpcy50b2tlbiA9IG51bGw7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd3b3Jrc3BhY2VfdXNlcl9pZCcpO1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnd29ya3NwYWNlX3VzZXJuYW1lJyk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd3b3Jrc3BhY2VfdG9rZW4nKTtcbiAgICAgICAgdGhpcy5lbWl0KCdhdXRoLWNoYW5nZScsIG51bGwpO1xuICAgICAgICBcbiAgICAgICAgLy8gw4ltZXR0cmUgdW4gw6l2w6luZW1lbnQgZ2xvYmFsIHBvdXIgQ2hhdE1hbmFnZXJcbiAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdhdXRoLWNoYW5nZScsIHsgZGV0YWlsOiB7IHVzZXI6IG51bGwgfSB9KSk7XG4gICAgfVxuXG4gICAgaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy51c2VyICE9PSBudWxsICYmIHRoaXMudG9rZW4gIT09IG51bGw7XG4gICAgfVxuXG4gICAgZ2V0Q3VycmVudFVzZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVzZXI7XG4gICAgfVxuXG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRva2VuO1xuICAgIH1cblxuICAgIG9uKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmxpc3RlbmVycy5wdXNoKHsgZXZlbnQsIGNhbGxiYWNrIH0pO1xuICAgIH1cblxuICAgIGVtaXQoZXZlbnQsIGRhdGEpIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMuZm9yRWFjaChsaXN0ZW5lciA9PiB7XG4gICAgICAgICAgICBpZiAobGlzdGVuZXIuZXZlbnQgPT09IGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXIuY2FsbGJhY2soZGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzID0gW107XG4gICAgICAgIHRoaXMudXNlciA9IG51bGw7XG4gICAgICAgIHRoaXMudG9rZW4gPSBudWxsO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXV0aE1hbmFnZXI7XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./public/assets/js/modules/auth/AuthManager.js\n\n}");

/***/ })

}]);