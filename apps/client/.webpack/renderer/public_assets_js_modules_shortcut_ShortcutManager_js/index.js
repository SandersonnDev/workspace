"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkworkspace_client"] = self["webpackChunkworkspace_client"] || []).push([["public_assets_js_modules_shortcut_ShortcutManager_js"],{

/***/ "./public/assets/js/modules/shortcut/ShortcutManager.js":
/*!**************************************************************!*\
  !*** ./public/assets/js/modules/shortcut/ShortcutManager.js ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ShortcutManager)\n/* harmony export */ });\nclass ShortcutManager {\n    constructor(options = {}) {\n        this.categories = [];\n        this.searchQuery = '';\n        this.listeners = [];\n        this.serverUrl = options.serverUrl || 'http://localhost:8060';\n    }\n\n    async init() {\n        this.checkAuthentication();\n        await this.loadShortcuts();\n        this.render();\n        this.attachEventListeners();\n        this.setupKeyboardShortcuts();\n        this.listenAuthChanges();\n    }\n\n    checkAuthentication() {\n        const authRequired = document.getElementById('shortcut-auth-required');\n        const content = document.getElementById('shortcut-content');\n        const isAuth = this.isAuthenticated();\n\n        if (authRequired && content) {\n            if (isAuth) {\n                authRequired.classList.add('hidden');\n                content.style.display = 'block';\n            } else {\n                authRequired.classList.remove('hidden');\n                content.style.display = 'none';\n            }\n        }\n    }\n\n    listenAuthChanges() {\n        window.addEventListener('auth-change', () => {\n            this.checkAuthentication();\n            this.loadShortcuts().then(() => this.render());\n        });\n\n        const loginBtn = document.getElementById('shortcut-login-btn');\n        if (loginBtn) {\n            loginBtn.addEventListener('click', () => {\n                // Déclencher l'ouverture de la modal de login\n                const btnLogin = document.getElementById('btnLogin');\n                if (btnLogin) btnLogin.click();\n            });\n        }\n    }\n\n    destroy() {\n        this.listeners.forEach(({ element, event, handler }) => {\n            element?.removeEventListener(event, handler);\n        });\n        this.listeners = [];\n        document.removeEventListener('keydown', this.globalKeyHandler);\n    }\n\n    addListener(element, event, handler) {\n        if (element) {\n            element.addEventListener(event, handler);\n            this.listeners.push({ element, event, handler });\n        }\n    }\n\n    async loadShortcuts() {\n        const userId = localStorage.getItem('workspace_user_id');\n        \n        if (!userId) {\n            this.categories = [];\n            return;\n        }\n\n        try {\n            const token = this.getAuthToken();\n            const headers = token ? { 'Authorization': `Bearer ${token}` } : { 'X-User-Id': userId };\n            \n            const [categoriesRes, shortcutsRes] = await Promise.all([\n                fetch(`${this.serverUrl}/api/shortcuts/categories`, {\n                    headers: headers\n                }),\n                fetch(`${this.serverUrl}/api/shortcuts`, {\n                    headers: headers\n                })\n            ]);\n\n            const categoriesData = await categoriesRes.json();\n            const shortcutsData = await shortcutsRes.json();\n\n            if (categoriesData.success && shortcutsData.success) {\n                this.categories = categoriesData.categories.map(cat => ({\n                    id: cat.id,\n                    name: cat.name,\n                    shortcuts: shortcutsData.shortcuts\n                        .filter(s => s.category_id === cat.id)\n                        .map(s => ({ id: s.id, name: s.name, url: s.url }))\n                }));\n            } else {\n                this.categories = [];\n            }\n        } catch (error) {\n            console.error('❌ Erreur chargement raccourcis:', error);\n            this.categories = [];\n        }\n    }\n\n    async saveShortcuts() {\n        // Plus besoin de sauvegarder localement, l'API gère la persistance\n    }\n\n    getUserId() {\n        return localStorage.getItem('workspace_user_id');\n    }\n\n    isAuthenticated() {\n        return !!this.getUserId();\n    }\n\n    setupKeyboardShortcuts() {\n        this.globalKeyHandler = (e) => {\n            if ((e.ctrlKey || e.metaKey) && e.key === 'f') {\n                e.preventDefault();\n                const searchInput = document.getElementById('shortcut-search-input');\n                searchInput?.focus();\n            }\n        };\n        document.addEventListener('keydown', this.globalKeyHandler);\n    }\n\n    attachEventListeners() {\n        const searchInput = document.getElementById('shortcut-search-input');\n        if (searchInput) {\n            const handler = (e) => {\n                this.searchQuery = e.target.value.toLowerCase();\n                this.render();\n            };\n            this.addListener(searchInput, 'input', handler);\n        }\n\n        const addCategoryBtn = document.getElementById('add-category-btn');\n        if (addCategoryBtn) {\n            const handler = () => this.openAddCategoryModal();\n            this.addListener(addCategoryBtn, 'click', handler);\n        }\n    }\n\n    filterCategories() {\n        if (!this.searchQuery) return this.categories;\n\n        return this.categories.map(cat => ({\n            ...cat,\n            shortcuts: cat.shortcuts.filter(shortcut =>\n                shortcut.name.toLowerCase().includes(this.searchQuery) ||\n                shortcut.url.toLowerCase().includes(this.searchQuery)\n            )\n        })).filter(cat => cat.shortcuts.length > 0);\n    }\n\n    render() {\n        const grid = document.getElementById('shortcut-grid');\n        if (!grid) return;\n\n        const filteredCategories = this.filterCategories();\n        \n        if (filteredCategories.length === 0) {\n            grid.innerHTML = '<p class=\"shortcut-empty-message\">Aucun raccourci trouvé</p>';\n            return;\n        }\n\n        grid.innerHTML = filteredCategories.map(category => this.renderCategory(category)).join('');\n        this.attachCategoryListeners();\n    }\n\n    renderCategory(category) {\n        return `\n            <div class=\"shortcut-container\" data-category-id=\"${category.id}\">\n                <div class=\"shortcut-title\">\n                    <h3>${this.escapeHtml(category.name)}</h3>\n                    <button class=\"shortcut-manage-btn\" data-category-id=\"${category.id}\" title=\"Gérer les raccourcis\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                </div>\n                <div class=\"shortcut-links\">\n                    ${category.shortcuts.map(shortcut => this.renderShortcut(shortcut)).join('')}\n                </div>\n            </div>\n        `;\n    }\n\n    renderShortcut(shortcut) {\n        return `\n            <button class=\"shortcut-link\" data-url=\"${this.escapeHtml(shortcut.url)}\" data-name=\"${this.escapeHtml(shortcut.name)}\" aria-label=\"Ouvrir ${this.escapeHtml(shortcut.name)}\">\n                <i class=\"fas fa-link\"></i> ${this.escapeHtml(shortcut.name)}\n            </button>\n        `;\n    }\n\n    attachCategoryListeners() {\n        document.querySelectorAll('.shortcut-link').forEach(btn => {\n            btn.addEventListener('click', () => {\n                const url = btn.dataset.url;\n                if (url && window.electronAPI?.openExternal) {\n                    window.electronAPI.openExternal(url);\n                }\n            });\n        });\n\n        document.querySelectorAll('.shortcut-manage-btn').forEach(btn => {\n            btn.addEventListener('click', (e) => {\n                e.stopPropagation();\n                const categoryId = parseInt(btn.dataset.categoryId);\n                this.openManageModal(categoryId);\n            });\n        });\n    }\n\n    openAddCategoryModal() {\n        if (!this.isAuthenticated()) {\n            alert('Vous devez être connecté pour créer une catégorie');\n            return;\n        }\n\n        const modal = this.createModal('Ajouter une catégorie', `\n            <form id=\"add-category-form\">\n                <div class=\"form-group\">\n                    <label for=\"category-name\">Nom de la catégorie</label>\n                    <input type=\"text\" id=\"category-name\" required>\n                </div>\n                <div class=\"modal-actions\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-close>Annuler</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Créer</button>\n                </div>\n            </form>\n        `);\n\n        const form = modal.querySelector('#add-category-form');\n        form.addEventListener('submit', (e) => {\n            e.preventDefault();\n            const name = document.getElementById('category-name').value.trim();\n            if (name) {\n                this.addCategory(name);\n                modal.close();\n                modal.remove();\n            }\n        });\n\n        modal.querySelector('[data-close]').addEventListener('click', () => {\n            modal.close();\n            modal.remove();\n        });\n\n        document.body.appendChild(modal);\n        modal.showModal();\n        document.getElementById('category-name').focus();\n    }\n\n    openManageModal(categoryId) {\n        const category = this.categories.find(c => c.id === categoryId);\n        if (!category) return;\n\n        const modal = this.createModal(`Gérer \"${category.name}\"`, `\n            <div class=\"manage-shortcuts\">\n                <div class=\"shortcuts-list\" id=\"shortcuts-list\">\n                    ${category.shortcuts.length === 0 ? '<p class=\"shortcuts-empty\">Aucun raccourci dans cette catégorie</p>' : category.shortcuts.map(s => `\n                        <div class=\"shortcut-item\" data-shortcut-id=\"${s.id}\">\n                            <div class=\"shortcut-info\">\n                                <strong>${this.escapeHtml(s.name)}</strong>\n                                <small>${this.escapeHtml(s.url)}</small>\n                            </div>\n                            <button class=\"btn-icon btn-delete\" data-delete-shortcut=\"${s.id}\" title=\"Supprimer\">\n                                <i class=\"fas fa-trash\"></i>\n                            </button>\n                        </div>\n                    `).join('')}\n                </div>\n                <form id=\"add-shortcut-form\">\n                    <div class=\"form-row\">\n                        <input type=\"text\" id=\"shortcut-name\" placeholder=\"Nom\" required>\n                        <input type=\"url\" id=\"shortcut-url\" placeholder=\"URL\" required>\n                        <button type=\"submit\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-plus\"></i> Ajouter\n                        </button>\n                    </div>\n                </form>\n                <div class=\"modal-actions\">\n                    <button type=\"button\" class=\"btn btn-danger\" data-delete-category>Supprimer la catégorie</button>\n                    <button type=\"button\" class=\"btn btn-secondary\" data-close>Fermer</button>\n                </div>\n            </div>\n        `);\n\n        const addForm = modal.querySelector('#add-shortcut-form');\n        addForm.addEventListener('submit', (e) => {\n            e.preventDefault();\n            const name = document.getElementById('shortcut-name').value.trim();\n            const url = document.getElementById('shortcut-url').value.trim();\n            if (name && url) {\n                this.addShortcut(categoryId, name, url);\n                modal.close();\n                modal.remove();\n                this.render();\n            }\n        });\n\n        modal.querySelectorAll('[data-delete-shortcut]').forEach(btn => {\n            btn.addEventListener('click', () => {\n                const shortcutId = parseInt(btn.dataset.deleteShortcut);\n                this.deleteShortcut(categoryId, shortcutId);\n                modal.close();\n                modal.remove();\n                this.render();\n            });\n        });\n\n        modal.querySelector('[data-delete-category]').addEventListener('click', () => {\n            if (confirm(`Supprimer la catégorie \"${category.name}\" et tous ses raccourcis ?`)) {\n                this.deleteCategory(categoryId);\n                modal.close();\n                modal.remove();\n                this.render();\n            }\n        });\n\n        modal.querySelector('[data-close]').addEventListener('click', () => {\n            modal.close();\n            modal.remove();\n        });\n\n        document.body.appendChild(modal);\n        modal.showModal();\n    }\n\n    createModal(title, content) {\n        const modal = document.createElement('dialog');\n        modal.className = 'universal-modal';\n        modal.innerHTML = `\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h3>${this.escapeHtml(title)}</h3>\n                </div>\n                <div class=\"modal-body\">\n                    ${content}\n                </div>\n            </div>\n        `;\n        return modal;\n    }\n\n    getAuthToken() {\n        return localStorage.getItem('workspace_token');\n    }\n\n    async addCategory(name) {\n        const userId = this.getUserId();\n        \n        if (!userId) {\n            alert('Vous devez être connecté pour créer une catégorie');\n            return;\n        }\n\n        try {\n            const token = this.getAuthToken();\n            const headers = {\n                'Content-Type': 'application/json'\n            };\n            if (token) {\n                headers['Authorization'] = `Bearer ${token}`;\n            } else {\n                headers['X-User-Id'] = userId;\n            }\n\n            const response = await fetch(`${this.serverUrl}/api/shortcuts/categories`, {\n                method: 'POST',\n                headers: headers,\n                body: JSON.stringify({ name })\n            });\n\n            const data = await response.json();\n\n            if (data.success) {\n                await this.loadShortcuts();\n                this.render();\n            } else {\n                alert(data.message);\n            }\n        } catch (error) {\n            console.error('❌ Erreur création catégorie:', error);\n            alert('Erreur lors de la création de la catégorie');\n        }\n    }\n\n    async deleteCategory(categoryId) {\n        const userId = this.getUserId();\n        \n        if (!userId) return;\n\n        try {\n            const token = this.getAuthToken();\n            const headers = {};\n            if (token) {\n                headers['Authorization'] = `Bearer ${token}`;\n            } else {\n                headers['X-User-Id'] = userId;\n            }\n\n            const response = await fetch(`${this.serverUrl}/api/shortcuts/categories/${categoryId}`, {\n                method: 'DELETE',\n                headers: headers\n            });\n\n            const data = await response.json();\n\n            if (data.success) {\n                await this.loadShortcuts();\n                this.render();\n            }\n        } catch (error) {\n            console.error('❌ Erreur suppression catégorie:', error);\n        }\n    }\n\n    async addShortcut(categoryId, name, url) {\n        const userId = this.getUserId();\n        \n        if (!userId) {\n            alert('Vous devez être connecté pour ajouter un raccourci');\n            return;\n        }\n\n        try {\n            const token = this.getAuthToken();\n            const headers = {\n                'Content-Type': 'application/json'\n            };\n            if (token) {\n                headers['Authorization'] = `Bearer ${token}`;\n            } else {\n                headers['X-User-Id'] = userId;\n            }\n\n            const response = await fetch(`${this.serverUrl}/api/shortcuts`, {\n                method: 'POST',\n                headers: headers,\n                body: JSON.stringify({ category_id: categoryId, name, url })\n            });\n\n            const data = await response.json();\n\n            if (data.success) {\n                await this.loadShortcuts();\n                this.render();\n            } else {\n                alert(data.message);\n            }\n        } catch (error) {\n            console.error('❌ Erreur création raccourci:', error);\n            alert('Erreur lors de la création du raccourci');\n        }\n    }\n\n    async deleteShortcut(categoryId, shortcutId) {\n        const userId = this.getUserId();\n        \n        if (!userId) return;\n\n        try {\n            const token = this.getAuthToken();\n            const headers = {};\n            if (token) {\n                headers['Authorization'] = `Bearer ${token}`;\n            } else {\n                headers['X-User-Id'] = userId;\n            }\n\n            const response = await fetch(`${this.serverUrl}/api/shortcuts/${shortcutId}`, {\n                method: 'DELETE',\n                headers: headers\n            });\n\n            const data = await response.json();\n\n            if (data.success) {\n                await this.loadShortcuts();\n                this.render();\n            }\n        } catch (error) {\n            console.error('❌ Erreur suppression raccourci:', error);\n        }\n    }\n\n    escapeHtml(text) {\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wdWJsaWMvYXNzZXRzL2pzL21vZHVsZXMvc2hvcnRjdXQvU2hvcnRjdXRNYW5hZ2VyLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBZTtBQUNmLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7O0FBRUE7QUFDQSxrQ0FBa0MseUJBQXlCO0FBQzNEO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MseUJBQXlCO0FBQzNEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHNDQUFzQywyQkFBMkIsTUFBTSxJQUFJLElBQUk7QUFDL0U7QUFDQTtBQUNBLHlCQUF5QixlQUFlO0FBQ3hDO0FBQ0EsaUJBQWlCO0FBQ2pCLHlCQUF5QixlQUFlO0FBQ3hDO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLG9DQUFvQztBQUN6RSxpQkFBaUI7QUFDakIsY0FBYztBQUNkO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FB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QUViOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELE1BQU07QUFDM0QsY0FBYztBQUNkO0FBQ0E7O0FBRUEsNENBQTRDLGVBQWUsaUJBQWlCLFdBQVc7QUFDdkY7QUFDQTtBQUNBLGFBQWE7O0FBRWI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL3dvcmtzcGFjZS1jbGllbnQvLi9wdWJsaWMvYXNzZXRzL2pzL21vZHVsZXMvc2hvcnRjdXQvU2hvcnRjdXRNYW5hZ2VyLmpzPzRlNTEiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2hvcnRjdXRNYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHtcbiAgICAgICAgdGhpcy5jYXRlZ29yaWVzID0gW107XG4gICAgICAgIHRoaXMuc2VhcmNoUXVlcnkgPSAnJztcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBbXTtcbiAgICAgICAgdGhpcy5zZXJ2ZXJVcmwgPSBvcHRpb25zLnNlcnZlclVybCB8fCAnaHR0cDovL2xvY2FsaG9zdDo4MDYwJztcbiAgICB9XG5cbiAgICBhc3luYyBpbml0KCkge1xuICAgICAgICB0aGlzLmNoZWNrQXV0aGVudGljYXRpb24oKTtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2hvcnRjdXRzKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIHRoaXMuYXR0YWNoRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5zZXR1cEtleWJvYXJkU2hvcnRjdXRzKCk7XG4gICAgICAgIHRoaXMubGlzdGVuQXV0aENoYW5nZXMoKTtcbiAgICB9XG5cbiAgICBjaGVja0F1dGhlbnRpY2F0aW9uKCkge1xuICAgICAgICBjb25zdCBhdXRoUmVxdWlyZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcnRjdXQtYXV0aC1yZXF1aXJlZCcpO1xuICAgICAgICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0LWNvbnRlbnQnKTtcbiAgICAgICAgY29uc3QgaXNBdXRoID0gdGhpcy5pc0F1dGhlbnRpY2F0ZWQoKTtcblxuICAgICAgICBpZiAoYXV0aFJlcXVpcmVkICYmIGNvbnRlbnQpIHtcbiAgICAgICAgICAgIGlmIChpc0F1dGgpIHtcbiAgICAgICAgICAgICAgICBhdXRoUmVxdWlyZWQuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgY29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXV0aFJlcXVpcmVkLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxpc3RlbkF1dGhDaGFuZ2VzKCkge1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYXV0aC1jaGFuZ2UnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNoZWNrQXV0aGVudGljYXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMubG9hZFNob3J0Y3V0cygpLnRoZW4oKCkgPT4gdGhpcy5yZW5kZXIoKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGxvZ2luQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0LWxvZ2luLWJ0bicpO1xuICAgICAgICBpZiAobG9naW5CdG4pIHtcbiAgICAgICAgICAgIGxvZ2luQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIETDqWNsZW5jaGVyIGwnb3V2ZXJ0dXJlIGRlIGxhIG1vZGFsIGRlIGxvZ2luXG4gICAgICAgICAgICAgICAgY29uc3QgYnRuTG9naW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuTG9naW4nKTtcbiAgICAgICAgICAgICAgICBpZiAoYnRuTG9naW4pIGJ0bkxvZ2luLmNsaWNrKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLmZvckVhY2goKHsgZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIgfSkgPT4ge1xuICAgICAgICAgICAgZWxlbWVudD8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcik7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IFtdO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5nbG9iYWxLZXlIYW5kbGVyKTtcbiAgICB9XG5cbiAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBldmVudCwgaGFuZGxlcikge1xuICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyKTtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLnB1c2goeyBlbGVtZW50LCBldmVudCwgaGFuZGxlciB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTaG9ydGN1dHMoKSB7XG4gICAgICAgIGNvbnN0IHVzZXJJZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd3b3Jrc3BhY2VfdXNlcl9pZCcpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgICAgIHRoaXMuY2F0ZWdvcmllcyA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gdGhpcy5nZXRBdXRoVG9rZW4oKTtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0b2tlbiA/IHsgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCB9IDogeyAnWC1Vc2VyLUlkJzogdXNlcklkIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IFtjYXRlZ29yaWVzUmVzLCBzaG9ydGN1dHNSZXNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgICAgIGZldGNoKGAke3RoaXMuc2VydmVyVXJsfS9hcGkvc2hvcnRjdXRzL2NhdGVnb3JpZXNgLCB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBmZXRjaChgJHt0aGlzLnNlcnZlclVybH0vYXBpL3Nob3J0Y3V0c2AsIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgY29uc3QgY2F0ZWdvcmllc0RhdGEgPSBhd2FpdCBjYXRlZ29yaWVzUmVzLmpzb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHNob3J0Y3V0c0RhdGEgPSBhd2FpdCBzaG9ydGN1dHNSZXMuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoY2F0ZWdvcmllc0RhdGEuc3VjY2VzcyAmJiBzaG9ydGN1dHNEYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzRGF0YS5jYXRlZ29yaWVzLm1hcChjYXQgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGNhdC5pZCxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogY2F0Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNob3J0Y3V0czogc2hvcnRjdXRzRGF0YS5zaG9ydGN1dHNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIocyA9PiBzLmNhdGVnb3J5X2lkID09PSBjYXQuaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKHMgPT4gKHsgaWQ6IHMuaWQsIG5hbWU6IHMubmFtZSwgdXJsOiBzLnVybCB9KSlcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY2F0ZWdvcmllcyA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycmV1ciBjaGFyZ2VtZW50IHJhY2NvdXJjaXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5jYXRlZ29yaWVzID0gW107XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2hvcnRjdXRzKCkge1xuICAgICAgICAvLyBQbHVzIGJlc29pbiBkZSBzYXV2ZWdhcmRlciBsb2NhbGVtZW50LCBsJ0FQSSBnw6hyZSBsYSBwZXJzaXN0YW5jZVxuICAgIH1cblxuICAgIGdldFVzZXJJZCgpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd3b3Jrc3BhY2VfdXNlcl9pZCcpO1xuICAgIH1cblxuICAgIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5nZXRVc2VySWQoKTtcbiAgICB9XG5cbiAgICBzZXR1cEtleWJvYXJkU2hvcnRjdXRzKCkge1xuICAgICAgICB0aGlzLmdsb2JhbEtleUhhbmRsZXIgPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLmtleSA9PT0gJ2YnKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0LXNlYXJjaC1pbnB1dCcpO1xuICAgICAgICAgICAgICAgIHNlYXJjaElucHV0Py5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5nbG9iYWxLZXlIYW5kbGVyKTtcbiAgICB9XG5cbiAgICBhdHRhY2hFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgY29uc3Qgc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcnRjdXQtc2VhcmNoLWlucHV0Jyk7XG4gICAgICAgIGlmIChzZWFyY2hJbnB1dCkge1xuICAgICAgICAgICAgY29uc3QgaGFuZGxlciA9IChlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hRdWVyeSA9IGUudGFyZ2V0LnZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmFkZExpc3RlbmVyKHNlYXJjaElucHV0LCAnaW5wdXQnLCBoYW5kbGVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFkZENhdGVnb3J5QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC1jYXRlZ29yeS1idG4nKTtcbiAgICAgICAgaWYgKGFkZENhdGVnb3J5QnRuKSB7XG4gICAgICAgICAgICBjb25zdCBoYW5kbGVyID0gKCkgPT4gdGhpcy5vcGVuQWRkQ2F0ZWdvcnlNb2RhbCgpO1xuICAgICAgICAgICAgdGhpcy5hZGRMaXN0ZW5lcihhZGRDYXRlZ29yeUJ0biwgJ2NsaWNrJywgaGFuZGxlcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmaWx0ZXJDYXRlZ29yaWVzKCkge1xuICAgICAgICBpZiAoIXRoaXMuc2VhcmNoUXVlcnkpIHJldHVybiB0aGlzLmNhdGVnb3JpZXM7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuY2F0ZWdvcmllcy5tYXAoY2F0ID0+ICh7XG4gICAgICAgICAgICAuLi5jYXQsXG4gICAgICAgICAgICBzaG9ydGN1dHM6IGNhdC5zaG9ydGN1dHMuZmlsdGVyKHNob3J0Y3V0ID0+XG4gICAgICAgICAgICAgICAgc2hvcnRjdXQubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHRoaXMuc2VhcmNoUXVlcnkpIHx8XG4gICAgICAgICAgICAgICAgc2hvcnRjdXQudXJsLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGhpcy5zZWFyY2hRdWVyeSlcbiAgICAgICAgICAgIClcbiAgICAgICAgfSkpLmZpbHRlcihjYXQgPT4gY2F0LnNob3J0Y3V0cy5sZW5ndGggPiAwKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IGdyaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcnRjdXQtZ3JpZCcpO1xuICAgICAgICBpZiAoIWdyaWQpIHJldHVybjtcblxuICAgICAgICBjb25zdCBmaWx0ZXJlZENhdGVnb3JpZXMgPSB0aGlzLmZpbHRlckNhdGVnb3JpZXMoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChmaWx0ZXJlZENhdGVnb3JpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBncmlkLmlubmVySFRNTCA9ICc8cCBjbGFzcz1cInNob3J0Y3V0LWVtcHR5LW1lc3NhZ2VcIj5BdWN1biByYWNjb3VyY2kgdHJvdXbDqTwvcD4nO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZ3JpZC5pbm5lckhUTUwgPSBmaWx0ZXJlZENhdGVnb3JpZXMubWFwKGNhdGVnb3J5ID0+IHRoaXMucmVuZGVyQ2F0ZWdvcnkoY2F0ZWdvcnkpKS5qb2luKCcnKTtcbiAgICAgICAgdGhpcy5hdHRhY2hDYXRlZ29yeUxpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHJlbmRlckNhdGVnb3J5KGNhdGVnb3J5KSB7XG4gICAgICAgIHJldHVybiBgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwic2hvcnRjdXQtY29udGFpbmVyXCIgZGF0YS1jYXRlZ29yeS1pZD1cIiR7Y2F0ZWdvcnkuaWR9XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNob3J0Y3V0LXRpdGxlXCI+XG4gICAgICAgICAgICAgICAgICAgIDxoMz4ke3RoaXMuZXNjYXBlSHRtbChjYXRlZ29yeS5uYW1lKX08L2gzPlxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwic2hvcnRjdXQtbWFuYWdlLWJ0blwiIGRhdGEtY2F0ZWdvcnktaWQ9XCIke2NhdGVnb3J5LmlkfVwiIHRpdGxlPVwiR8OpcmVyIGxlcyByYWNjb3VyY2lzXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS1jb2dcIj48L2k+XG4gICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzaG9ydGN1dC1saW5rc1wiPlxuICAgICAgICAgICAgICAgICAgICAke2NhdGVnb3J5LnNob3J0Y3V0cy5tYXAoc2hvcnRjdXQgPT4gdGhpcy5yZW5kZXJTaG9ydGN1dChzaG9ydGN1dCkpLmpvaW4oJycpfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgfVxuXG4gICAgcmVuZGVyU2hvcnRjdXQoc2hvcnRjdXQpIHtcbiAgICAgICAgcmV0dXJuIGBcbiAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJzaG9ydGN1dC1saW5rXCIgZGF0YS11cmw9XCIke3RoaXMuZXNjYXBlSHRtbChzaG9ydGN1dC51cmwpfVwiIGRhdGEtbmFtZT1cIiR7dGhpcy5lc2NhcGVIdG1sKHNob3J0Y3V0Lm5hbWUpfVwiIGFyaWEtbGFiZWw9XCJPdXZyaXIgJHt0aGlzLmVzY2FwZUh0bWwoc2hvcnRjdXQubmFtZSl9XCI+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYXMgZmEtbGlua1wiPjwvaT4gJHt0aGlzLmVzY2FwZUh0bWwoc2hvcnRjdXQubmFtZSl9XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgYDtcbiAgICB9XG5cbiAgICBhdHRhY2hDYXRlZ29yeUxpc3RlbmVycygpIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNob3J0Y3V0LWxpbmsnKS5mb3JFYWNoKGJ0biA9PiB7XG4gICAgICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdXJsID0gYnRuLmRhdGFzZXQudXJsO1xuICAgICAgICAgICAgICAgIGlmICh1cmwgJiYgd2luZG93LmVsZWN0cm9uQVBJPy5vcGVuRXh0ZXJuYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmVsZWN0cm9uQVBJLm9wZW5FeHRlcm5hbCh1cmwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2hvcnRjdXQtbWFuYWdlLWJ0bicpLmZvckVhY2goYnRuID0+IHtcbiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjYXRlZ29yeUlkID0gcGFyc2VJbnQoYnRuLmRhdGFzZXQuY2F0ZWdvcnlJZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuTWFuYWdlTW9kYWwoY2F0ZWdvcnlJZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb3BlbkFkZENhdGVnb3J5TW9kYWwoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0F1dGhlbnRpY2F0ZWQoKSkge1xuICAgICAgICAgICAgYWxlcnQoJ1ZvdXMgZGV2ZXogw6p0cmUgY29ubmVjdMOpIHBvdXIgY3LDqWVyIHVuZSBjYXTDqWdvcmllJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtb2RhbCA9IHRoaXMuY3JlYXRlTW9kYWwoJ0Fqb3V0ZXIgdW5lIGNhdMOpZ29yaWUnLCBgXG4gICAgICAgICAgICA8Zm9ybSBpZD1cImFkZC1jYXRlZ29yeS1mb3JtXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cImNhdGVnb3J5LW5hbWVcIj5Ob20gZGUgbGEgY2F0w6lnb3JpZTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGlkPVwiY2F0ZWdvcnktbmFtZVwiIHJlcXVpcmVkPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1hY3Rpb25zXCI+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1zZWNvbmRhcnlcIiBkYXRhLWNsb3NlPkFubnVsZXI8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwic3VibWl0XCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIj5DcsOpZXI8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgYCk7XG5cbiAgICAgICAgY29uc3QgZm9ybSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJyNhZGQtY2F0ZWdvcnktZm9ybScpO1xuICAgICAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhdGVnb3J5LW5hbWUnKS52YWx1ZS50cmltKCk7XG4gICAgICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2F0ZWdvcnkobmFtZSk7XG4gICAgICAgICAgICAgICAgbW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICBtb2RhbC5yZW1vdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcignW2RhdGEtY2xvc2VdJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBtb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgbW9kYWwucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobW9kYWwpO1xuICAgICAgICBtb2RhbC5zaG93TW9kYWwoKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhdGVnb3J5LW5hbWUnKS5mb2N1cygpO1xuICAgIH1cblxuICAgIG9wZW5NYW5hZ2VNb2RhbChjYXRlZ29yeUlkKSB7XG4gICAgICAgIGNvbnN0IGNhdGVnb3J5ID0gdGhpcy5jYXRlZ29yaWVzLmZpbmQoYyA9PiBjLmlkID09PSBjYXRlZ29yeUlkKTtcbiAgICAgICAgaWYgKCFjYXRlZ29yeSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IG1vZGFsID0gdGhpcy5jcmVhdGVNb2RhbChgR8OpcmVyIFwiJHtjYXRlZ29yeS5uYW1lfVwiYCwgYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1hbmFnZS1zaG9ydGN1dHNcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic2hvcnRjdXRzLWxpc3RcIiBpZD1cInNob3J0Y3V0cy1saXN0XCI+XG4gICAgICAgICAgICAgICAgICAgICR7Y2F0ZWdvcnkuc2hvcnRjdXRzLmxlbmd0aCA9PT0gMCA/ICc8cCBjbGFzcz1cInNob3J0Y3V0cy1lbXB0eVwiPkF1Y3VuIHJhY2NvdXJjaSBkYW5zIGNldHRlIGNhdMOpZ29yaWU8L3A+JyA6IGNhdGVnb3J5LnNob3J0Y3V0cy5tYXAocyA9PiBgXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic2hvcnRjdXQtaXRlbVwiIGRhdGEtc2hvcnRjdXQtaWQ9XCIke3MuaWR9XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNob3J0Y3V0LWluZm9cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cm9uZz4ke3RoaXMuZXNjYXBlSHRtbChzLm5hbWUpfTwvc3Ryb25nPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+JHt0aGlzLmVzY2FwZUh0bWwocy51cmwpfTwvc21hbGw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0bi1pY29uIGJ0bi1kZWxldGVcIiBkYXRhLWRlbGV0ZS1zaG9ydGN1dD1cIiR7cy5pZH1cIiB0aXRsZT1cIlN1cHByaW1lclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS10cmFzaFwiPjwvaT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICBgKS5qb2luKCcnKX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8Zm9ybSBpZD1cImFkZC1zaG9ydGN1dC1mb3JtXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLXJvd1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJzaG9ydGN1dC1uYW1lXCIgcGxhY2Vob2xkZXI9XCJOb21cIiByZXF1aXJlZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidXJsXCIgaWQ9XCJzaG9ydGN1dC11cmxcIiBwbGFjZWhvbGRlcj1cIlVSTFwiIHJlcXVpcmVkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPVwic3VibWl0XCIgY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhcyBmYS1wbHVzXCI+PC9pPiBBam91dGVyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1hY3Rpb25zXCI+XG4gICAgICAgICAgICAgICAgICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiYnRuIGJ0bi1kYW5nZXJcIiBkYXRhLWRlbGV0ZS1jYXRlZ29yeT5TdXBwcmltZXIgbGEgY2F0w6lnb3JpZTwvYnV0dG9uPlxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIiBjbGFzcz1cImJ0biBidG4tc2Vjb25kYXJ5XCIgZGF0YS1jbG9zZT5GZXJtZXI8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgKTtcblxuICAgICAgICBjb25zdCBhZGRGb3JtID0gbW9kYWwucXVlcnlTZWxlY3RvcignI2FkZC1zaG9ydGN1dC1mb3JtJyk7XG4gICAgICAgIGFkZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcnRjdXQtbmFtZScpLnZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzaG9ydGN1dC11cmwnKS52YWx1ZS50cmltKCk7XG4gICAgICAgICAgICBpZiAobmFtZSAmJiB1cmwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFNob3J0Y3V0KGNhdGVnb3J5SWQsIG5hbWUsIHVybCk7XG4gICAgICAgICAgICAgICAgbW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICBtb2RhbC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1kZWxldGUtc2hvcnRjdXRdJykuZm9yRWFjaChidG4gPT4ge1xuICAgICAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNob3J0Y3V0SWQgPSBwYXJzZUludChidG4uZGF0YXNldC5kZWxldGVTaG9ydGN1dCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxldGVTaG9ydGN1dChjYXRlZ29yeUlkLCBzaG9ydGN1dElkKTtcbiAgICAgICAgICAgICAgICBtb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIG1vZGFsLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcignW2RhdGEtZGVsZXRlLWNhdGVnb3J5XScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNvbmZpcm0oYFN1cHByaW1lciBsYSBjYXTDqWdvcmllIFwiJHtjYXRlZ29yeS5uYW1lfVwiIGV0IHRvdXMgc2VzIHJhY2NvdXJjaXMgP2ApKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxldGVDYXRlZ29yeShjYXRlZ29yeUlkKTtcbiAgICAgICAgICAgICAgICBtb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIG1vZGFsLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWNsb3NlXScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgbW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgIG1vZGFsLnJlbW92ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG1vZGFsKTtcbiAgICAgICAgbW9kYWwuc2hvd01vZGFsKCk7XG4gICAgfVxuXG4gICAgY3JlYXRlTW9kYWwodGl0bGUsIGNvbnRlbnQpIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaWFsb2cnKTtcbiAgICAgICAgbW9kYWwuY2xhc3NOYW1lID0gJ3VuaXZlcnNhbC1tb2RhbCc7XG4gICAgICAgIG1vZGFsLmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJtb2RhbC1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8aDM+JHt0aGlzLmVzY2FwZUh0bWwodGl0bGUpfTwvaDM+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vZGFsLWJvZHlcIj5cbiAgICAgICAgICAgICAgICAgICAgJHtjb250ZW50fVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG4gICAgICAgIHJldHVybiBtb2RhbDtcbiAgICB9XG5cbiAgICBnZXRBdXRoVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnd29ya3NwYWNlX3Rva2VuJyk7XG4gICAgfVxuXG4gICAgYXN5bmMgYWRkQ2F0ZWdvcnkobmFtZSkge1xuICAgICAgICBjb25zdCB1c2VySWQgPSB0aGlzLmdldFVzZXJJZCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF1c2VySWQpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdWb3VzIGRldmV6IMOqdHJlIGNvbm5lY3TDqSBwb3VyIGNyw6llciB1bmUgY2F0w6lnb3JpZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gdGhpcy5nZXRBdXRoVG9rZW4oKTtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgICAgIGhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzWydYLVVzZXItSWQnXSA9IHVzZXJJZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLnNlcnZlclVybH0vYXBpL3Nob3J0Y3V0cy9jYXRlZ29yaWVzYCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lIH0pXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgICAgICAgaWYgKGRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZFNob3J0Y3V0cygpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGFsZXJ0KGRhdGEubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyZXVyIGNyw6lhdGlvbiBjYXTDqWdvcmllOicsIGVycm9yKTtcbiAgICAgICAgICAgIGFsZXJ0KCdFcnJldXIgbG9ycyBkZSBsYSBjcsOpYXRpb24gZGUgbGEgY2F0w6lnb3JpZScpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZGVsZXRlQ2F0ZWdvcnkoY2F0ZWdvcnlJZCkge1xuICAgICAgICBjb25zdCB1c2VySWQgPSB0aGlzLmdldFVzZXJJZCgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF1c2VySWQpIHJldHVybjtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdG9rZW4gPSB0aGlzLmdldEF1dGhUb2tlbigpO1xuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgaWYgKHRva2VuKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gYEJlYXJlciAke3Rva2VufWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhlYWRlcnNbJ1gtVXNlci1JZCddID0gdXNlcklkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuc2VydmVyVXJsfS9hcGkvc2hvcnRjdXRzL2NhdGVnb3JpZXMvJHtjYXRlZ29yeUlkfWAsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2hvcnRjdXRzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJldXIgc3VwcHJlc3Npb24gY2F0w6lnb3JpZTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBhZGRTaG9ydGN1dChjYXRlZ29yeUlkLCBuYW1lLCB1cmwpIHtcbiAgICAgICAgY29uc3QgdXNlcklkID0gdGhpcy5nZXRVc2VySWQoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICghdXNlcklkKSB7XG4gICAgICAgICAgICBhbGVydCgnVm91cyBkZXZleiDDqnRyZSBjb25uZWN0w6kgcG91ciBham91dGVyIHVuIHJhY2NvdXJjaScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRva2VuID0gdGhpcy5nZXRBdXRoVG9rZW4oKTtcbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0b2tlbikge1xuICAgICAgICAgICAgICAgIGhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzWydYLVVzZXItSWQnXSA9IHVzZXJJZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLnNlcnZlclVybH0vYXBpL3Nob3J0Y3V0c2AsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgY2F0ZWdvcnlfaWQ6IGNhdGVnb3J5SWQsIG5hbWUsIHVybCB9KVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICAgICAgICAgIGlmIChkYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmxvYWRTaG9ydGN1dHMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbGVydChkYXRhLm1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEVycmV1ciBjcsOpYXRpb24gcmFjY291cmNpOicsIGVycm9yKTtcbiAgICAgICAgICAgIGFsZXJ0KCdFcnJldXIgbG9ycyBkZSBsYSBjcsOpYXRpb24gZHUgcmFjY291cmNpJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBkZWxldGVTaG9ydGN1dChjYXRlZ29yeUlkLCBzaG9ydGN1dElkKSB7XG4gICAgICAgIGNvbnN0IHVzZXJJZCA9IHRoaXMuZ2V0VXNlcklkKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXVzZXJJZCkgcmV0dXJuO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB0b2tlbiA9IHRoaXMuZ2V0QXV0aFRva2VuKCk7XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0ge307XG4gICAgICAgICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSBgQmVhcmVyICR7dG9rZW59YDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyc1snWC1Vc2VyLUlkJ10gPSB1c2VySWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5zZXJ2ZXJVcmx9L2FwaS9zaG9ydGN1dHMvJHtzaG9ydGN1dElkfWAsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2hvcnRjdXRzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJldXIgc3VwcHJlc3Npb24gcmFjY291cmNpOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGVzY2FwZUh0bWwodGV4dCkge1xuICAgICAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZGl2LnRleHRDb250ZW50ID0gdGV4dDtcbiAgICAgICAgcmV0dXJuIGRpdi5pbm5lckhUTUw7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./public/assets/js/modules/shortcut/ShortcutManager.js\n\n}");

/***/ })

}]);